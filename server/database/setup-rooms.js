const db = require('./init');
const { v4: uuidv4 } = require('uuid');

/**
 * Script to create/reset rooms for 7-Eleven Training System
 * Run this script to set up or update training rooms
 */

function setupRooms() {
  console.log('ğŸ¢ Setting up training rooms...');

  const rooms = [
    {
      name: 'à¸«à¹‰à¸­à¸‡à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸à¸²à¸£à¹à¸„à¸Šà¹€à¸Šà¸µà¸¢à¸£à¹Œ (Cashier Lab)',
      description: 'à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸¶à¸à¸—à¸±à¸à¸©à¸°à¸à¸²à¸£à¹ƒà¸Šà¹‰à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡ POS à¹à¸¥à¸°à¸à¸²à¸£à¸šà¸£à¸´à¸à¸²à¸£à¸à¸²à¸™à¹€à¸‡à¸´à¸™ à¸£à¸­à¸‡à¸£à¸±à¸šà¸­à¸¸à¸›à¸à¸£à¸“à¹Œà¹à¸„à¸Šà¹€à¸Šà¸µà¸¢à¸£à¹Œ 4 à¸Šà¸¸à¸”',
      capacity: 20
    },
    {
      name: 'à¸«à¹‰à¸­à¸‡à¹€à¸•à¸£à¸µà¸¢à¸¡à¸ªà¸´à¸™à¸„à¹‰à¸²à¸­à¸¸à¹ˆà¸™à¸£à¹‰à¸­à¸™ (Food Prep Room)',
      description: 'à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸¶à¸à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸­à¸¸à¸›à¸à¸£à¸“à¹Œà¸­à¸¸à¹ˆà¸™à¸£à¹‰à¸­à¸™à¹à¸¥à¸°à¸ªà¸¸à¸‚à¸­à¸™à¸²à¸¡à¸±à¸¢à¸­à¸²à¸«à¸²à¸£ à¸à¸£à¹‰à¸­à¸¡à¸•à¸¹à¹‰à¸­à¸¸à¹ˆà¸™à¹à¸¥à¸°à¸­à¸¸à¸›à¸à¸£à¸“à¹Œà¸„à¸£à¸±à¸§',
      capacity: 15
    },
    {
      name: 'à¸«à¹‰à¸­à¸‡à¸ˆà¸±à¸”à¹€à¸£à¸µà¸¢à¸‡à¸ªà¸´à¸™à¸„à¹‰à¸² (Merchandise Room)',
      description: 'à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸¶à¸à¸à¸²à¸£à¸ˆà¸±à¸”à¹€à¸£à¸µà¸¢à¸‡à¸ªà¸´à¸™à¸„à¹‰à¸²à¹à¸¥à¸°à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸„à¸¸à¸“à¸ à¸²à¸ à¸à¸£à¹‰à¸­à¸¡à¸Šà¸±à¹‰à¸™à¸§à¸²à¸‡à¸ªà¸´à¸™à¸„à¹‰à¸²à¸ˆà¸³à¸¥à¸­à¸‡',
      capacity: 25
    },
    {
      name: 'à¸«à¹‰à¸­à¸‡à¸„à¸¥à¸±à¸‡à¸ªà¸´à¸™à¸„à¹‰à¸² (Storage Room)',
      description: 'à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸¶à¸à¸à¸²à¸£à¸£à¸±à¸šà¸ªà¸´à¸™à¸„à¹‰à¸² FIFO/FEFO à¹à¸¥à¸°à¸à¸²à¸£à¸™à¸±à¸šà¸ªà¸•à¹Šà¸­à¸ à¸à¸£à¹‰à¸­à¸¡à¸£à¸°à¸šà¸šà¸ˆà¸±à¸”à¹€à¸à¹‡à¸šà¸ªà¸´à¸™à¸„à¹‰à¸²',
      capacity: 15
    },
    {
      name: 'à¸«à¹‰à¸­à¸‡à¸šà¸£à¸£à¸¢à¸²à¸¢ A (Lecture Room A)',
      description: 'à¸«à¹‰à¸­à¸‡à¸šà¸£à¸£à¸¢à¸²à¸¢à¸‚à¸™à¸²à¸”à¹ƒà¸«à¸à¹ˆà¸à¸£à¹‰à¸­à¸¡à¸­à¸¸à¸›à¸à¸£à¸“à¹Œ AV à¸„à¸£à¸šà¸„à¸£à¸±à¸™ à¹‚à¸›à¸£à¹€à¸ˆà¸„à¹€à¸•à¸­à¸£à¹Œ HD à¹à¸¥à¸°à¸£à¸°à¸šà¸šà¹€à¸ªà¸µà¸¢à¸‡',
      capacity: 50
    },
    {
      name: 'à¸«à¹‰à¸­à¸‡à¸šà¸£à¸£à¸¢à¸²à¸¢ B (Lecture Room B)',
      description: 'à¸«à¹‰à¸­à¸‡à¸šà¸£à¸£à¸¢à¸²à¸¢à¸‚à¸™à¸²à¸”à¸à¸¥à¸²à¸‡à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸¥à¸¸à¹ˆà¸¡à¸¢à¹ˆà¸­à¸¢ à¸à¸£à¹‰à¸­à¸¡à¸ˆà¸­ LED à¹à¸¥à¸°à¹„à¸§à¸—à¹Œà¸šà¸­à¸£à¹Œà¸”',
      capacity: 30
    },
    {
      name: 'à¸«à¹‰à¸­à¸‡à¸›à¸£à¸°à¸Šà¸¸à¸¡à¸à¸¥à¸¸à¹ˆà¸¡à¸¢à¹ˆà¸­à¸¢ (Group Discussion Room)',
      description: 'à¸«à¹‰à¸­à¸‡à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸à¸¥à¸¸à¹ˆà¸¡à¹à¸¥à¸°à¹à¸¥à¸à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸„à¸§à¸²à¸¡à¸„à¸´à¸”à¹€à¸«à¹‡à¸™ à¸ˆà¸±à¸”à¸—à¸µà¹ˆà¸™à¸±à¹ˆà¸‡à¹à¸šà¸šà¸§à¸‡à¸à¸¥à¸¡',
      capacity: 12
    },
    {
      name: 'Demo Store (à¸£à¹‰à¸²à¸™à¸ªà¸²à¸˜à¸´à¸•)',
      description: 'à¸£à¹‰à¸²à¸™ 7-Eleven à¸ˆà¸³à¸¥à¸­à¸‡à¸ªà¸¡à¸ˆà¸£à¸´à¸‡à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸¶à¸à¸›à¸à¸´à¸šà¸±à¸•à¸´ à¸„à¸£à¸šà¸—à¸¸à¸à¸ˆà¸¸à¸”à¸šà¸£à¸´à¸à¸²à¸£',
      capacity: 10
    },
    {
      name: 'à¸«à¹‰à¸­à¸‡à¸à¸¶à¸à¸­à¸šà¸£à¸¡à¸„à¸¸à¸“à¸ à¸²à¸à¸­à¸²à¸«à¸²à¸£ (Food Safety Lab)',
      description: 'à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸¶à¸à¸¡à¸²à¸•à¸£à¸à¸²à¸™à¸ªà¸¸à¸‚à¸­à¸™à¸²à¸¡à¸±à¸¢à¸­à¸²à¸«à¸²à¸£à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢ à¸à¸£à¹‰à¸­à¸¡à¸­à¸¸à¸›à¸à¸£à¸“à¹Œà¸—à¸”à¸ªà¸­à¸š',
      capacity: 18
    },
    {
      name: 'à¸«à¹‰à¸­à¸‡à¸„à¸­à¸¡à¸à¸´à¸§à¹€à¸•à¸­à¸£à¹Œ (Computer Lab)',
      description: 'à¸«à¹‰à¸­à¸‡à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸à¸²à¸£à¸„à¸­à¸¡à¸à¸´à¸§à¹€à¸•à¸­à¸£à¹Œà¸ªà¸³à¸«à¸£à¸±à¸šà¸£à¸°à¸šà¸š POS à¹à¸¥à¸°à¸à¸²à¸£à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ à¸à¸£à¹‰à¸­à¸¡ PC 20 à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡',
      capacity: 20
    }
  ];

  let created = 0;
  let errors = 0;

  rooms.forEach((room, index) => {
    const roomId = uuidv4();
    db.run(
      `INSERT OR IGNORE INTO rooms (room_id, name, description, capacity, status) 
       VALUES (?, ?, ?, ?, ?)`,
      [roomId, room.name, room.description, room.capacity, 'available'],
      function(err) {
        if (err) {
          console.error(`âŒ Error creating room "${room.name}":`, err.message);
          errors++;
        } else if (this.changes > 0) {
          console.log(`âœ… Created: ${room.name}`);
          created++;
        }
        
        // Check if this is the last room
        if (index === rooms.length - 1) {
          setTimeout(() => {
            console.log('\nğŸ“Š Summary:');
            console.log(`   âœ… Created: ${created} rooms`);
            console.log(`   â­ï¸  Skipped: ${rooms.length - created - errors} rooms (already exist)`);
            if (errors > 0) {
              console.log(`   âŒ Errors: ${errors}`);
            }
            console.log('\nğŸ‰ Room setup complete!');
            process.exit(0);
          }, 500);
        }
      }
    );
  });
}

// Run the setup
setupRooms();
